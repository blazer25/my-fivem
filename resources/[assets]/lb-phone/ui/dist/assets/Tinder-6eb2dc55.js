import{am as Le,ar as F,r as h,j as o,a as e,bQ as _e,k as Oe,H as re,t as x,Q as ye,m as Ae,L as m,d as V,a8 as Z,cA as Fe,ct as He,u as H,P as U,F as B,I as Ue,i as Ve,cB as te,bD as se,C as _,b as ae,ay as Me,v as ie,w as G,K as $e,N as We,a2 as Ce,cl as Be,a7 as z,X as De,ad as be,a6 as ce,q as Ie,aR as Ge,cc as Ye,A as je,z as ze,ca as he,as as Ke,ap as Xe,aX as le,ac as qe,b0 as Je}from"./index-569b241b.js";import{T as Re}from"./Textarea-61cff3f3.js";var Qe=function(r){return new Promise(function(d){setTimeout(d,r)})};const ge=Le(Qe),k={snapBackDuration:300,maxTilt:5,bouncePower:.1,swipeThreshold:100},Ze=t=>{const r=window.getComputedStyle(t),d=r.getPropertyValue("width"),f=Number(d.split("px")[0]),p=r.getPropertyValue("height"),w=Number(p.split("px")[0]);return{x:f,y:w}},Se=(t,r)=>Math.sqrt(Math.pow(t,2)+Math.pow(r,2)),et=(t,r=1)=>{const d=Math.sqrt(Math.pow(t.x,2)+Math.pow(t.y,2));return{x:t.x*r/d,y:t.y*r/d}},de=async(t,r,d=!1)=>{const f=ne(t),p=Ze(document.body),w=Se(p.x,p.y),i=Se(r.x,r.y),v=w/i,T=w/i,s=fe(r.x*T+f.x,-r.y*T+f.y);let l="";const c=200;d?t.style.transition="ease "+v+"s":t.style.transition="ease-out "+v+"s",q(t)===0?l=J((Math.random()-.5)*c):q(t)>0?l=J(Math.random()*c/2+q(t)):l=J((Math.random()-1)*c/2+q(t)),t.style.transform=s+l,await ge(v*1e3)},we=async t=>{t.style.transition=k.snapBackDuration+"ms";const r=ne(t),d=fe(r.x*-k.bouncePower,r.y*-k.bouncePower),f=J(q(t)*-k.bouncePower);t.style.transform=d+f,await ge(k.snapBackDuration*.75),t.style.transform="none",await ge(k.snapBackDuration),t.style.transition="10ms"},Te=t=>{if(Math.abs(t.x)>Math.abs(t.y)){if(t.x>k.swipeThreshold)return"right";if(t.x<-k.swipeThreshold)return"left"}else{if(t.y>k.swipeThreshold)return"up";if(t.y<-k.swipeThreshold)return"down"}return"none"},ke=(t,r)=>{const d=r.x-t.x,f=t.y-r.y,p=(r.time-t.time)/1e3;return{x:d/p,y:f/p}},fe=(t,r)=>"translate("+t+"px)",J=t=>"rotate("+t+"deg)",ne=t=>{const r=window.getComputedStyle(t),d=new DOMMatrix(r.transform);return{x:d.m41,y:-d.m42}},q=t=>{const r=window.getComputedStyle(t),d=new DOMMatrix(r.transform);return-Math.asin(d.m21)/(2*Math.PI)*360},tt=(t,r,d,f)=>{const p={x:t.x+d.x,y:t.y+d.y},w={x:p.x,y:p.y,time:new Date().getTime()},i=fe(p.x),v=ke(f,w).x/1e3,T=J(v*k.maxTilt);return r.style.transform=i+T,w},me=t=>{const r=t.targetTouches[0];return{x:r.clientX,y:r.clientY}},ue=t=>({x:t.clientX,y:t.clientY}),st=F.forwardRef(({flickOnSwipe:t=!0,children:r,onSwipe:d,onCardLeftScreen:f,className:p,preventSwipe:w=[],swipeRequirementType:i="velocity",swipeThreshold:v=k.swipeThreshold,onSwipeRequirementFulfilled:T,onSwipeRequirementUnfulfilled:s},l)=>{k.swipeThreshold=v;const c=F.useRef(!1),g=F.useRef();F.useImperativeHandle(l,()=>({async swipe(N="right"){d&&d(N);const I=1e3,y=(Math.random()-.5)*100;N==="right"?await de(g.current,{x:I,y},!0):N==="left"&&await de(g.current,{x:-I,y},!0),g.current.style.display="none",f&&f(N)},async restoreCard(){g.current.style.display="block",await we(g.current)}}));const a=F.useCallback(async(N,I)=>{if(c.current)return;c.current=!0;const y=ne(N),M=Te(i==="velocity"?I:y);if(M!=="none"&&(d&&d(M),t&&!w.includes(M))){const E=i==="velocity"?I:et(y,600);await de(N,E),N.style.display="none",f&&f(M);return}we(N)},[c,t,d,f,w,i]),S=F.useCallback(()=>{c.current=!1},[c]);return F.useLayoutEffect(()=>{let N={x:null,y:null},I={x:0,y:0},y={x:0,y:0,time:new Date().getTime()},M=!1,E="none";g.current.addEventListener("touchstart",u=>{u.preventDefault(),S(),N={x:-me(u).x,y:-me(u).y}},{passive:!1}),g.current.addEventListener("mousedown",u=>{u.preventDefault(),M=!0,S(),N={x:-ue(u).x,y:-ue(u).y}});const n=u=>{if(T||s){const b=Te(i==="velocity"?I:ne(g.current));b!==E&&(E=b,E==="none"?s&&s():T&&T(b))}const A=tt(u,g.current,N,y);I=ke(y,A),y=A};g.current.addEventListener("touchmove",u=>{u.preventDefault(),n(me(u))},{passive:!1}),g.current.addEventListener("mousemove",u=>{u.preventDefault(),M&&n(ue(u))}),g.current.addEventListener("touchend",u=>{u.preventDefault(),a(g.current,I)},{passive:!1}),g.current.addEventListener("mouseup",u=>{M&&(u.preventDefault(),M=!1,a(g.current,I))}),g.current.addEventListener("mouseleave",u=>{M&&(u.preventDefault(),M=!1,a(g.current,I))})},[]),F.createElement("div",{ref:g,className:p},r)});function pe(){const{View:t}=h.useContext(Y),[r,d]=t;return o("div",{className:"home-header",children:[e(_e,{onClick:()=>d("profile")}),e("img",{className:"logo",src:"./assets/img/icons/tinder/logo.svg",onClick:()=>d("home")}),e(Oe,{onClick:()=>d("messageList")})]})}const $={account:{name:"James",bio:"I'm a cool guy",dob:9624888e5,photos:["https://r2.fivemanage.com/images/GRBUI6C4orbD.webp","https://r2.fivemanage.com/images/98avzSwlgzsg.webp","https://r2.fivemanage.com/images/rafgjPwSYnn2.png"],showMen:!1,showWomen:!0,isMale:!0,active:!0},accounts:[{number:"1",dob:9653888e5,name:"Jessica",bio:"Swipe right if you like dogs",photos:["https://r2.fivemanage.com/images/oRKcdeTA8oBy.png"],isMale:!1,matched:!0},{number:"2",dob:9653888e5,name:"Klara",bio:"Member of Lost MC, looking for a good time",photos:["https://r2.fivemanage.com/images/787FMzhn5xD5.png","https://r2.fivemanage.com/images/ZsmnyJOA2rc5.png"],isMale:!1,liked:!0},{number:"3",dob:9653888e5,name:"Steph",bio:"Evening strolls are my thing",photos:["https://r2.fivemanage.com/images/7zj3Xgy6FsXK.png"],matched:!0,isMale:!1,lastMessage:"I'm perfect, you look good!",lastSender:"1234567890"},{number:"4",dob:9653888e5,name:"Lisa",bio:"I love to cook and bake",photos:["https://r2.fivemanage.com/images/7zj3Xgy6FsXK.png"],matched:!0,isMale:!1,lastMessage:"I love to cook and bake",lastSender:"4",unread:!0}],messages:{3:[{id:1,sender:"1234567890",content:"Im perfect, you look good!",timestamp:Date.now()-1e3*60*60*24*1},{id:2,sender:"1234567890",content:"I'm good, how about you?",timestamp:Date.now()-1e3*60*60*24*2},{id:3,sender:"1234567890",content:"Hey, how are you?",timestamp:Date.now()-1e3*60*60*24*3}],4:[{id:1,sender:"4",content:"HIII",timestamp:Date.now()-1e3*60*60*20}]}};function at(){var Ee;const{View:t,User:r,Account:d}=h.useContext(Y),[f,p]=t,[w,i]=r,[v,T]=d,[s,l]=h.useState([]),[c,g]=h.useState(0),[a,S]=h.useState(),N=h.useRef(c),I=h.useRef(0),[y,M]=h.useState([]),[E,n]=h.useState(0),[u,A]=h.useState(!1),[b,D]=h.useState(null);let[O,j]=h.useState("");h.useEffect(()=>{re("Tinder")&&x("Tinder",{action:"getFeed",page:0},$.accounts.filter(P=>!P.matched)).then(P=>{P&&P.length>0?(l(P),g(P.length-1),I.current=P.length,M(Array(P.length).fill(0).map(C=>F.createRef()))):A(!0)})},[]);const K=P=>{g(P),N.current=P},X=c<s.length-1,R=c>=0,W=(P,C,L)=>{S(P),K(L-1),Pe(),P==="right"?x("Tinder",{action:"swipe",like:!0,number:C.number},$.accounts.find(ee=>ee.liked&&ee.number==C.number)).then(ee=>{ee&&D(C)}):P==="left"&&x("Tinder",{action:"swipe",like:!1,number:C.number})},ve=(P,C)=>{N.current>=C&&y[C].current.restoreCard()},Ne=async P=>{R&&c<s.length&&(await y[c].current.swipe(P),Pe())},xe=async()=>{var C,L;if(!X)return;const P=c+1;K(P),await((L=(C=y[P])==null?void 0:C.current)==null?void 0:L.restoreCard())},Pe=()=>{if(I.current>1){I.current=I.current-1;return}x("Tinder",{action:"getFeed",page:E+1}).then(P=>{if(P)if(P&&P.length>0){n(E+1);let C=P.length+s.length;l(L=>(L=[...L,...P],L)),I.current=P.length,g(C-1),M(Array(C).fill(0).map(L=>F.createRef()))}else A(!0)})};return o("div",{className:`home-wrapper slide ${f=="profile"?"left":"right"}`,children:[e(pe,{}),e(ye,{children:b&&o(Ae.div,{initial:{opacity:0,scale:.1},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.1},transition:{duration:.3,ease:"easeInOut"},className:"match",style:{backgroundImage:`url(${b.photos[0]})`},children:[e("img",{className:"match-image",src:"./assets/img/icons/tinder/match.png"}),o("div",{className:"likes-too",children:[b.name," ",(Ee=m("APPS.TINDER.LIKES_YOU_TOO"))==null?void 0:Ee.toLowerCase()]}),o("div",{className:"input",children:[e(V,{type:"text",placeholder:m("APPS.TINDER.SAY_SOMETHING_NICE"),onChange:P=>j(P.target.value)}),e("div",{className:"send",onClick:()=>{x("Tinder",{action:"sendMessage",data:{recipient:b.number,content:O}},!0).then(P=>{P&&(i(b),p("message"))})},children:m("APPS.TINDER.SEND")})]}),e("div",{className:"keep-swiping",onClick:()=>D(null),children:m("APPS.TINDER.KEEP_SWIPING")})]})}),o("div",{className:"home-body",children:[o("div",{className:"cards",children:[u&&e("div",{className:"card no-more",children:e("div",{children:m("APPS.TINDER.NO_MORE")})}),!v.active&&e("div",{className:"card no-more",children:e("div",{children:m("APPS.TINDER.HIDDEN_PROFILE")})}),v.active&&s.map((P,C)=>e(st,{ref:y[C],className:"swipe",onSwipe:L=>W(L,P,C),onCardLeftScreen:()=>ve(P,C),children:e(nt,{user:P})},C))]}),o("div",{className:"actions",children:[e("div",{className:"button",onClick:()=>Ne("left"),children:e(Z,{style:{color:"#F24C65"}})}),e("div",{className:`button small ${X?"":"disabled"}`,onClick:()=>xe(),children:e(Fe,{style:{rotate:"180deg",color:"#F2B721"}})}),e("div",{className:"button",onClick:()=>Ne("right"),children:e(He,{style:{color:"#3CDBA7"}})})]})]})]})}const nt=t=>{let r=t.user;const[d,f]=h.useState(0),[p,w]=h.useState(0);return h.useEffect(()=>{w(Q(r.dob))},[r]),o("div",{className:"card",style:{backgroundImage:`url(${r.photos[d]})`},onClick:i=>{d<r.photos.length-1?f(d+1):f(0)},children:[r.photos.length>1&&e("div",{className:"image-count",children:r.photos.map((i,v)=>e("div",{className:`image ${v==d?"active":""}`,onClick:T=>{T.stopPropagation(),f(v)}}))}),o("div",{className:"card-content",children:[o("div",{className:"name",children:[r.name," ",e("span",{children:p})]}),e("div",{className:"description",children:r.bio})]})]})};function ot(){var M;const{LoggedIn:t,Account:r}=h.useContext(Y),d=H(U.PhoneNumber),[f,p]=r,[w,i]=t,[v,T]=h.useState("notLoggedIn"),[s,l]=h.useState(0),[c,g]=h.useState({});h.useEffect(()=>{re("Tinder")&&(v=="notLoggedIn"?U.Styles.TextColor.set("#ffffff"):U.Styles.TextColor.set("#000000"))},[v]);const[a,S]=h.useState({name:null,photos:[],_dob:{day:"",month:"",year:""},dob:null,bio:null,showMen:!1,showWomen:!1,isMale:null,active:!0}),N=E=>{var n,u,A;switch(E){case 0:let b=new Date(`${(n=a._dob)==null?void 0:n.year}/${(u=a._dob)==null?void 0:u.month}/${(A=a._dob)==null?void 0:A.day}`);if(I(b)){let D=Q(b);a.name&&a.name.length>=2&&D>=18&&D<=100&&(S({...a,dob:b.getTime()}),l(E+1))}break;case 1:a.photos.length>0&&l(E+1);break;case 2:a.bio&&a.bio.length>=10&&l(E+1);break;case 3:(a.showMen||a.showWomen)&&l(E+1);break;case 4:(a.isMale==!0||a.isMale==!1)&&x("Tinder",{action:"createAccount",data:{...a,dob:new Date(a.dob).toISOString().split("T")[0]}},!0).then(D=>{if(!D)return ie("error","Failed to create account");G.APPS.TINDER.account.set(a),p(a),i(!0)});break}},I=E=>E.getTime()===E.getTime();let y=[m("APPS.TINDER.CREATE_ACCOUNT"),m("APPS.TINDER.ADD_PHOTOS"),m("APPS.TINDER.DESCRIPTION"),m("APPS.TINDER.SHOW_ME"),m("APPS.TINDER.I_AM")];return e("div",{className:"login-container",style:{background:v==="notLoggedIn"?"linear-gradient(45deg, #ff4573, #ff5f65)":"#ffffff"},children:v==="notLoggedIn"?o(B,{children:[o("div",{className:"logo",children:[e("img",{src:"./assets/img/icons/tinder/logo-white.svg"}),e("div",{className:"logo-text",children:(M=m("APPS.TINDER.TITLE"))==null?void 0:M.toLowerCase()})]}),o("div",{className:"buttons",children:[e("div",{className:"disclamer",children:m("APPS.TINDER.AGREE_TERMS")}),e("div",{className:"button create",onClick:()=>T("createAccount"),children:m("APPS.TINDER.CREATE_ACCOUNT")})]})]}):o("div",{className:"create-account",children:[o("div",{className:"login-header",children:[e(Ue,{onClick:()=>{s>0?l(s-1):T("notLoggedIn")}}),e("div",{className:"title",children:y[s]})]}),s==0&&e(B,{children:o("div",{className:"form-body",children:[e(V,{defaultValue:Ve(d),type:"text",disabled:!0}),e(V,{placeholder:"Name",type:"text",maxLength:25,onChange:E=>{S({...a,name:E.target.value}),E.target.value.length>=3?g({...c,name:!0}):g({...c,name:!1})}}),o("div",{className:"dob",children:[o("div",{className:"inputs",children:[e(V,{placeholder:"MM",type:"text",pattern:"/^-?\\d+\\.?\\d*$/",minLength:2,maxLength:2,onChange:E=>{S({...a,_dob:{...a._dob,month:E.target.value}})}}),e("span",{children:"/"}),e(V,{placeholder:"DD",type:"text",pattern:"/^-?\\d+\\.?\\d*$/",minLength:2,maxLength:2,onChange:E=>{S({...a,_dob:{...a._dob,day:E.target.value}})}}),e("span",{children:"/"}),e(V,{placeholder:"YYYY",type:"text",pattern:"/^-?\\d+\\.?\\d*$/",minLength:4,maxLength:4,onChange:E=>{var b,D,O;let n={...a,_dob:{...a._dob,year:E.target.value}};S(n);let u=new Date(`${(b=n._dob)==null?void 0:b.year}/${(D=n._dob)==null?void 0:D.month}/${(O=n._dob)==null?void 0:O.day}`),A=Q(u);A>=18&&A<100?g({...c,18:!0}):g({...c,18:!1})}})]}),e("div",{className:"disclamer",children:m("APPS.TINDER.AGE_PUBLIC")}),o("div",{className:"requirement",children:[c[18]?e(te,{className:"green"}):e(se,{className:"red"}),m("APPS.TINDER.BE_OVER_18")]}),o("div",{className:"requirement",children:[c.name?e(te,{className:"green"}):e(se,{className:"red"}),m("APPS.TINDER.NAME_MINIMUM")]})]})]})}),s==1&&o(B,{children:[e("div",{className:"photo-grid",children:[...Array(6)].map((E,n)=>{var A;let u=((A=a.photos)==null?void 0:A[n-1])||n==0;return a.photos[n]?e("div",{className:"photo",style:{backgroundImage:`url(${a.photos[n]})`},children:e("div",{className:"button remove",onClick:()=>{let b=a.photos;b.splice(n,1),S({...a,photos:b}),b.length==0&&g({...c,photos:!1})},children:e(Z,{})})}):e("div",{className:"photo",children:u&&e("div",{className:"button add",onClick:()=>{var b,D,O;_.Gallery.set({allowExternal:(O=(D=(b=ae)==null?void 0:b.value)==null?void 0:D.AllowExternal)==null?void 0:O.Spark,onSelect:j=>S({...a,photos:[...a.photos,j.src]})}),g({...c,photos:!0})},children:e(Me,{})})})})}),o("div",{className:"requirement",children:[c.photos?e(te,{className:"green"}):e(se,{className:"red"}),m("APPS.TINDER.PHOTOS_MINIMUM")]})]}),s==2&&o(B,{children:[e(Re,{placeholder:"Description",maxLength:200,onChange:E=>{S({...a,bio:E.target.value}),E.target.value.length>=10?g({...c,bio:!0}):g({...c,bio:!1})}}),o("div",{className:"requirement",children:[c.bio?e(te,{className:"green"}):e(se,{className:"red"}),m("APPS.TINDER.DESCRIPTION_MINIMUM")]})]}),s==3&&e(B,{children:o("div",{className:"showme",children:[e("div",{className:`button border ${a.showWomen&&!a.showMen?"active":""}`,onClick:()=>{S({...a,showMen:!1,showWomen:!0})},children:m("APPS.TINDER.WOMEN")}),e("div",{className:`button border ${a.showMen&&!a.showWomen?"active":""}`,onClick:()=>{S({...a,showMen:!0,showWomen:!1})},children:m("APPS.TINDER.MEN")}),e("div",{className:`button border ${a.showMen&&a.showWomen?"active":""}`,onClick:()=>{S({...a,showMen:!0,showWomen:!0})},children:m("APPS.TINDER.EVERYONE")})]})}),s==4&&e(B,{children:o("div",{className:"showme",children:[e("div",{className:`button border ${a.isMale===!0?"active":""}`,onClick:()=>{S({...a,isMale:!0})},children:m("APPS.TINDER.MALE")}),e("div",{className:`button border ${a.isMale===!1?"active":""}`,onClick:()=>{S({...a,isMale:!1})},children:m("APPS.TINDER.FEMALE")})]})}),e("div",{className:"button gradient",onClick:()=>N(s),children:m("APPS.TINDER.CONTINUE")})]})})}const oe=$e(null);function rt(){var E;const{View:t,User:r}=h.useContext(Y);H(U.Settings);const d=H(U.PhoneNumber),f=H(je),[p,w]=r,[i,v]=t,T=H(oe),[s,l]=h.useState([]),c=h.useRef(!1),g=h.useRef(null),a=h.useRef(0),S=H(_.Emoji),[N,I]=h.useState({content:"",attachments:[]});h.useEffect(()=>{re("Tinder")&&(p!=null&&p.unread&&(c.current=!0),x("Tinder",{action:"getMessages",number:p.number},$.messages[p.number]).then(n=>{n&&n.length>0&&l(n.reverse())}))},[]),h.useEffect(()=>{var n;if(((n=f==null?void 0:f.active)==null?void 0:n.name)==="Tinder")return()=>{c.current&&x("Tinder",{action:"markAsRead",number:p.number})}},[f==null?void 0:f.active]);const y=()=>{if(N.content.length===0&&N.attachments.length===0)return;const n={sender:d,recipient:p.number,content:N.content,attachments:N.attachments,timestamp:new Date().getTime()};x("Tinder",{action:"sendMessage",data:n},!0).then(u=>{if(!u)return ie("error","Failed to send message");g.current.value="",I({content:"",attachments:[]}),l([...s,{...n,id:u}])})},{handleScroll:M}=We({fetchData:()=>{var n;return x("Tinder",{action:"getMessages",number:p.number,lastId:(n=s[s.length-1])==null?void 0:n.id})},onDataFetched:n=>{let u=document.querySelector(".message-container");a.current=u.scrollHeight,l([...n.reverse(),...s])},isReversed:!0,perPage:25});return h.useEffect(()=>{let n=document.querySelector(".message-container");const u=n.scrollHeight;n.scrollTop+=u-a.current,n.scroll},[s]),Ce("tinder:newMessage",n=>{p.number===n.sender&&(l([...s,n]),c.current=!0)}),o("div",{className:"home-wrapper slide left",children:[e(ye,{children:T&&e(it,{})}),o("div",{className:"message-header",children:[e(Be,{onClick:()=>{v("messageList"),w(null)}}),o("div",{className:"user",onClick:()=>oe.set(p),children:[e(z,{className:"profile-picture",src:(E=p.photos)==null?void 0:E[0]}),e("div",{className:"name",children:p.name})]})]}),e("div",{className:"message-container",onScroll:M,children:e("div",{className:"message-body",children:s.map((n,u)=>{var O,j,K,X;let A,b=n.sender===d?"self":"other",D=((O=s[u+1])==null?void 0:O.sender)===d?"self":"other";return s[u+1]?A=Math.abs(n.timestamp-s[u+1].timestamp)/36e5:D=void 0,o("div",{className:De("message",b),children:[b=="other"?o("div",{className:"message-with-pfp",children:[e("div",{className:`profile-picture ${b!==D?"show":"hide"}`,children:e(z,{src:(j=p.photos)==null?void 0:j[0]})}),o("div",{className:"message-content",children:[n.content&&e("div",{className:"content",children:be(n.content)}),((K=n.attachments)==null?void 0:K.length)>0&&e("div",{className:"attatchments",children:n.attachments.map((R,W)=>ce(R)?e("video",{src:R,controls:!1,loop:!0,autoPlay:!0,muted:!0,onClick:ve=>{_.FullscreenImage.set(R)}},W):e(z,{src:R,blur:!0,onClick:()=>{_.FullscreenImage.set(R)}},W))})]})]}):o(B,{children:[n.content&&e("div",{className:"content",children:be(n.content)}),((X=n.attachments)==null?void 0:X.length)>0&&e("div",{className:"attatchments",children:n.attachments.map((R,W)=>ce(R)?e("video",{src:R,controls:!1,loop:!0,autoPlay:!0,muted:!0,onClick:()=>{_.FullscreenImage.set(R)}},W):e(z,{src:R,onClick:()=>{_.FullscreenImage.set(R)}},W))})]}),s[u+1]&&A>6?e("div",{className:"date",children:Ie(n.timestamp)}):b!==D&&e("div",{className:"date",children:Ie(n.timestamp)})]},n.id)})})}),e("div",{className:"attachments",children:N.attachments.map((n,u)=>o("div",{className:"attachment",children:[ce(n)?e("video",{src:n,controls:!1,muted:!0,loop:!0,autoPlay:!0}):e(z,{src:n}),e(Z,{onClick:()=>{I({...N,attachments:N.attachments.filter((A,b)=>b!==u)})}})]}))}),o("div",{className:"message-bottom",children:[e(Ge,{className:"image",onClick:()=>{var n,u,A;N.attachments.length<3&&_.Gallery.set({includeVideos:!0,allowExternal:(A=(u=(n=ae)==null?void 0:n.value)==null?void 0:u.AllowExternal)==null?void 0:A.Messages,onSelect:b=>I({...N,attachments:[...N.attachments,b.src]})})}}),e("div",{className:"image",onClick:()=>{if(S)return _.Emoji.reset();_.Emoji.set({onSelect:n=>I(u=>({content:`${u.content}${n.emoji}`,attachments:u.attachments}))})},children:"ðŸ˜€"}),o("div",{className:"input",children:[e(V,{type:"text",placeholder:m("APPS.TINDER.TYPE_A_MESSAGE"),ref:g,value:N.content,onChange:n=>{I({...N,content:n.target.value})},onKeyDown:n=>{n.key==="Enter"&&y()}}),e(Ye,{className:N.attachments.length>0||N.content.length>0?"active":"",onClick:()=>y()})]})]})]})}const it=()=>{var f;const t=H(oe),[r,d]=h.useState(0);return t?o(Ae.div,{initial:{opacity:0,y:500},animate:{opacity:1,y:0},exit:{opacity:0,y:500},className:"popup-profile-container",children:[o("div",{className:"gallery",children:[e(z,{src:(f=t==null?void 0:t.photos)==null?void 0:f[r],onClick:()=>{t&&d(r<(t==null?void 0:t.photos.length)-1?r+1:0)}}),(t==null?void 0:t.photos.length)>1&&e("div",{className:"image-count",children:t==null?void 0:t.photos.map((p,w)=>e("div",{className:De("image",w==r&&"active"),onClick:i=>{i.stopPropagation(),d(w)}}))}),e("div",{className:"close",onClick:()=>oe.set(null),children:e(Z,{})})]}),o("div",{className:"card-content",children:[o("div",{className:"name",children:[t==null?void 0:t.name,", ",e("span",{children:Q(t==null?void 0:t.dob)})]}),e("div",{className:"divider"}),o("div",{className:"description",children:[e("div",{className:"title",children:m("APPS.TINDER.ABOUT_ME")}),t==null?void 0:t.bio]})]})]}):null};function ct(){const{View:t,User:r}=h.useContext(Y),d=H(U.PhoneNumber),[f,p]=r,[w,i]=t,[v,T]=h.useState({newMatches:[],messages:[]});return h.useEffect(()=>{re("Tinder")&&(U.Styles.TextColor.set("#000000"),x("Tinder",{action:"getMatches"},{newMatches:$.accounts.filter(s=>s.matched&&!$.messages[s.number]),messages:$.accounts.filter(s=>$.messages[s.number])}).then(s=>{if(!s)return ie("warning","No response received from Tinder getMatches");T(s)}))},[]),Ce("tinder:newMessage",s=>{s.sender!==U.PhoneNumber.value&&T(l=>{const c=l.messages.findIndex(a=>a.lastSender===s.sender),g=l.newMatches.findIndex(a=>a.lastSender===s.sender);if(c!==-1){const a=[...l.messages];return a[c]={...a[c],lastMessage:s.content,lastSender:s.sender,timestamp:s.timestamp,unread:!0},{...l,messages:a}}else if(g!==-1){const a=l.newMatches[g],S=l.newMatches.filter((I,y)=>y!==g),N={...a,lastMessage:s.content,lastSender:s.sender,timestamp:s.timestamp,unread:!0};return{...l,newMatches:S,messages:[N,...l.messages]}}else{const a={photos:[],lastMessage:s.content,lastSender:s.sender,timestamp:s.timestamp,unread:!0};return{...l,messages:[a,...l.messages]}}})}),o("div",{className:"home-wrapper slide left",children:[e(pe,{}),e(ze,{placeholder:m("APPS.TINDER.SEARCH_MATCHES"),onChange:()=>{}})," ",o("div",{className:"message-list-body",children:[o("div",{className:"new-matches",children:[o("div",{className:"title",children:[m("APPS.TINDER.NEW_MATCHES"),v.newMatches.length>0&&e("span",{children:v.newMatches.length})]}),e("div",{className:"matches",children:v.newMatches.map((s,l)=>{var c;return o("div",{className:"new-match",onClick:()=>{p(s),i("message")},children:[e(he,{className:"profile-picture",avatar:(c=s.photos)==null?void 0:c[0]}),e("div",{className:"name",children:s.name})]},l)})})]}),o("div",{className:"recent-messages",children:[e("div",{className:"title",children:m("APPS.TINDER.MESSAGES")}),e("div",{className:"messages",children:v.messages.map((s,l)=>{var g,a;((g=s.lastMessage)==null?void 0:g.length)===0&&(s.lastMessage=m("APPS.MESSAGES.SENT_A_PHOTO"));let c=s.lastSender===d;return o("div",{className:"message","data-selfsender":c,onClick:()=>{p(s),i("message")},children:[o("div",{className:"avatar",children:[e(he,{className:"profile-picture",avatar:(a=s.photos)==null?void 0:a[0]}),s.unread&&!c&&e("div",{className:"unread"})]}),o("div",{className:"user",children:[e("div",{className:"name",children:s.name}),o("div",{className:"message-content",children:[c&&e(Ke,{}),s.lastMessage.length>40?s.lastMessage.substring(0,40)+"...":s.lastMessage]})]})]},l)})})]})]})]})}function lt(){var T,s;const{Account:t,LoggedIn:r}=h.useContext(Y),[d,f]=r,[p,w]=t,[i,v]=h.useState(p);return o("div",{className:"home-wrapper slide right",style:{backgroundColor:"#F6F6F6"},children:[e(pe,{}),o("div",{className:"profile-body",children:[o("div",{className:"user",children:[e(he,{className:"profile-picture",avatar:i.photos[0]}),o("div",{className:"name",children:[i.name,", ",Q(i.dob)]})]}),o("div",{className:"inputs",children:[o("div",{className:"input",children:[e("div",{className:"label",children:m("APPS.TINDER.NAME")}),e(V,{type:"text",defaultValue:i.name,maxLength:25,onChange:l=>{v({...i,name:l.target.value})}})]}),o("div",{className:"input center",children:[e("div",{className:"label",children:m("APPS.TINDER.PHOTOS")}),e("div",{className:"photo-grid",children:[...Array(6)].map((l,c)=>{var a;let g=((a=i.photos)==null?void 0:a[c-1])||c==0;return i.photos[c]?e("div",{className:"photo",style:{backgroundImage:`url(${i.photos[c]})`},children:e("div",{className:"photo-button remove",onClick:()=>{let S=i.photos;S.splice(c,1),v({...i,photos:S})},children:e(Z,{})})},c):e("div",{className:"photo",children:g&&e("div",{className:"photo-button add",onClick:()=>{var S,N,I;_.Gallery.set({allowExternal:(I=(N=(S=ae)==null?void 0:S.value)==null?void 0:N.AllowExternal)==null?void 0:I.Spark,onSelect:y=>v({...i,photos:[...i.photos,y.src]})})},children:e(Me,{})})})})})]}),o("div",{className:"input",children:[e("div",{className:"label",children:m("APPS.TINDER.ABOUT_ME")}),e(Re,{type:"text",defaultValue:i.bio,maxLength:100,onChange:l=>{v({...i,bio:l.target.value})}})]}),o("div",{className:"input",children:[e("div",{className:"label",children:m("APPS.TINDER.INTERESTED_IN")}),o("select",{value:i.showMen&&i.showWomen?"Everyone":i.showMen?"Men":"Women",onChange:l=>{switch(l.target.value){case"Everyone":v({...i,showMen:!0,showWomen:!0});break;case"Men":v({...i,showMen:!0,showWomen:!1});break;case"Women":v({...i,showMen:!1,showWomen:!0});break}},children:[e("option",{value:"Men",children:m("APPS.TINDER.MEN")}),e("option",{value:"Women",children:m("APPS.TINDER.WOMEN")}),e("option",{value:"Everyone",children:m("APPS.TINDER.EVERYONE")})]})]}),o("div",{className:"input",children:[e("div",{className:"label",children:m("APPS.TINDER.GENDER")}),o("select",{value:i.isMale?"male":"female",onChange:l=>{l.target.value=="male"?v({...i,isMale:!0}):v({...i,isMale:!1})},children:[e("option",{value:"male",children:m("APPS.TINDER.MALE")}),e("option",{value:"female",children:m("APPS.TINDER.FEMALE")})]})]}),o("div",{className:"input",children:[e("div",{className:"label",children:m("APPS.TINDER.VISIBILITY")}),o("select",{value:i.active?"visible":"hidden",onChange:l=>{let c=l.target.value;v({...i,active:c==="visible"})},children:[e("option",{value:"visible",children:m("APPS.TINDER.VISIBLE")}),e("option",{value:"hidden",children:m("APPS.TINDER.HIDDEN")})]}),!i.active&&e("div",{className:"warning",children:m("APPS.TINDER.HIDDEN_WARNING")})]})]}),((s=(T=ae)==null?void 0:T.value)==null?void 0:s.DeleteAccount.Spark)&&e("div",{className:"button red",onClick:()=>{Xe("Tinder",()=>{w(null),f(!1)},!0)},children:m("APPS.TINDER.DELETE_ACCOUNT")}),e("div",{className:"button gradient",onClick:()=>{if(i.name.length>=2&&i.bio.length>=5&&i.photos.length>=1)x("Tinder",{action:"saveProfile",data:i},!0).then(l=>{if(!l)return ie("error","Issue saving Spark profile");G.APPS.TINDER.account.set(i),w(i)});else{let l="";switch(!0){case i.name.length<2:l=m("APPS.TINDER.ERROR.SHORT_NAME");break;case i.bio.length<5:l=m("APPS.TINDER.ERROR.SHORT_BIO");break;case i.photos.length<1:l=m("APPS.TINDER.ERROR.NO_PHOTOS");break}_.PopUp.set({title:m("APPS.TINDER.ERROR.TITLE"),description:l,buttons:[{title:m("APPS.TINDER.ERROR.OK")}]})}},children:m("APPS.TINDER.SAVE")})]})]})}const Y=h.createContext(null);function ut(){H(U.Settings);const[t,r]=h.useState(!1),[d,f]=h.useState(null),[p,w]=h.useState(null),[i,v]=h.useState("home"),[T,s]=h.useState(!0),l={home:e(at,{}),profile:e(lt,{}),messageList:e(ct,{}),message:e(rt,{})};return h.useEffect(()=>{if(G.APPS.TINDER.account.value){f(G.APPS.TINDER.account.value),r(!0),s(!1);return}else if(G.APPS.TINDER.account.value===!1)return s(!1);x("Tinder",{action:"isLoggedIn"},$.account).then(c=>{c?(f(c),r(!0),G.APPS.TINDER.account.set(c)):G.APPS.TINDER.account.set(!1),s(!1)})},[]),h.useEffect(()=>(i==="message"?le.ReceiveAppNotifications.set(!1):le.ReceiveAppNotifications.set(!0),()=>{le.ReceiveAppNotifications.set(!0)}),[i]),e("div",{className:"tinder-container",children:e(Y.Provider,{value:{LoggedIn:[t,r],Account:[d,f],User:[p,w],View:[i,v]},children:T||!qe()?e("div",{className:"loading",children:e(Je,{size:40,lineWeight:5,speed:2,color:"#000000"})}):t?l[i]:e(ot,{})})})}function Q(t){var r=+new Date(t);return~~((Date.now()-r)/315576e5)}export{Y as TinderContext,ut as default,Q as getAge};
